# Compatible with PS 5.1 only: https://learn.microsoft.com/en-us/powershell/azure/active-directory/install-adv2?view=azureadps-2.0
# UpdateÂ AzureADÂ users "manager" field in bulk from CSV fileÂ 
Â Â 
$ErrorActionPreferenceÂ = "Continue"Â 
Stop-Transcript | out-nullÂ 
Â Â 
Start-Transcript -path C:\Temp\AzureADManagers.txt -append
$Users = Import-CSV -Path "C:\Temp\AzureADUsers.csv"
Â Â Â 
Write-Host -ForegroundColorÂ White "Found: " + ($Users.Count()-1) + " users to update."
Write-Host -ForegroundColorÂ White "------------------------------"
ForEachÂ ($User in $Users) {
Â Â Write-Host -ForegroundColorÂ Green "Processing " + $User.UserUPNÂ + " ..."
Â  Try {
        Set-AzureADUserManagerÂ -ObjectIdÂ $User.UsersObjectIDÂ -RefObjectIdÂ $User.ManagersObjectIDÂ Â 
Â Â Â Â   }
Â Catch {Â  Write-Host "Error found:" $_.Exception -ForegroundColorÂ Red
Â }
Â Finally {  Write-Host -ForegroundColorÂ Yellow "Continuing with next user..."
Â Â           Write-Host -ForegroundColorÂ White "------------------------------"
Â }
}

Write-Host -ForegroundColorÂ Cyan "PROCESS COMPLETED!Â ðŸ™‚"
Stop-Transcript
