#UpdateÂ AzureADÂ users "manager" field in bulk from CSV fileÂ 
Â Â 
$ErrorActionPreferenceÂ = "Continue"Â 
Stop-Transcript | out-nullÂ 
Â Â 
Start-Transcript -path C:\Temp\AzureADManagers.txt -appendÂ 
$Users = Import-CSV -Path "C:\Temp\AzureADUsers.csv"Â 
Â Â Â 
Write-Host -ForegroundColorÂ White "Found: " + ($Users.Count()-1) + " users to update."Â 
Write-Host -ForegroundColorÂ White "------------------------------"Â 
ForEachÂ ($User in $Users) {Â 
Â Â Write-Host -ForegroundColorÂ Green "Processing " + $User.UserUPNÂ + " ..."Â 
Â Try {Â 
Set-AzureADUserManagerÂ -ObjectIdÂ $User.UsersObjectIDÂ -RefObjectIdÂ $User.ManagersObjectIDÂ Â Â Â Â Â Â Â Â 
Â Â Â Â  }Â 
Â Catch {Â  Write-Host "Error found:" $_.Exception -ForegroundColorÂ RedÂ Â 
Â Â Â Â  }Â 
Â Finally { Write-Host -ForegroundColorÂ Yellow "Continuing with next user..."Â Â 
Â Â  Write-Host -ForegroundColorÂ White "------------------------------"Â 
Â }Â 
}Â 
Â Â 
Write-Host -ForegroundColorÂ Cyan "PROCESS COMPLETED!Â ðŸ™‚"Â 
Stop-TranscriptÂ 
